# 控制台

**控制台** 是 CoPaw 内置的 Web 管理界面。运行 `copaw app` 后，在浏览器中打开
`http://127.0.0.1:8088/` 即可进入。

**在控制台中你可以：**

- 和 CoPaw 实时对话
- 启用/禁用消息频道并填写凭据
- 查看和管理所有聊天会话
- 创建定时执行的自动任务
- 编辑 CoPaw 的人设和行为文件
- 开关技能以扩展 CoPaw 的能力
- 配置 LLM 提供商并选择使用的模型
- 管理工具所需的环境变量

左侧侧边栏列出所有功能，分为 **聊天**、**控制**、**智能体**、**设置** 四组，点击即可
切换页面。下面按顺序逐一介绍每个功能的操作方法。

> **看不到控制台？** 请确认前端已构建，构建方式见 [CLI](./cli)。

---

## 聊天

> 侧边栏：**聊天 → 聊天**

这是你和 CoPaw 对话的地方。打开控制台后默认就是这个页面。

![聊天](https://img.alicdn.com/imgextra/i1/O1CN01kFaEFI1CrQCDRI0Oo_!!6000000000134-2-tps-4066-2118.png)

**发送消息：**
在底部输入框中输入内容，按 **Enter** 或点击发送按钮（↑），CoPaw 会实时回复。

**新建会话：**
点击顶部的 **+** 按钮，开始一段全新的对话。每个会话独立保存各自的对话记录。

**切换会话：**
点击顶部会话列表中的任意会话名称，即可加载该会话的历史消息。

**删除会话：**
鼠标悬停到会话条目上，点击出现的 **垃圾桶图标** 即可删除。

---

## 频道

> 侧边栏：**控制 → 频道**

在这里管理各消息频道（钉钉、飞书、Discord、QQ、iMessage、Console）的开关和凭据。

![频道](https://img.alicdn.com/imgextra/i4/O1CN01Uzu1Jt1CGK7AZ5EUG_!!6000000000053-2-tps-4066-2118.png)

**启用一个频道：**

1. 点击你要配置的频道卡片。
2. 右侧滑出配置面板，打开 **启用** 开关。
   ![频道配置](https://img.alicdn.com/imgextra/i3/O1CN01CHUNCJ1QAHViBKCtn_!!6000000001935-2-tps-4066-2118.png)
3. 填写该频道所需的凭据——每个频道要求不同：

   | 频道         | 需要填写的字段                                       |
   | ------------ | ---------------------------------------------------- |
   | **钉钉**     | Client ID、Client Secret                             |
   | **飞书**     | App ID、App Secret、加密密钥、验证令牌、媒体文件目录 |
   | **Discord**  | Bot Token、HTTP 代理、代理认证                       |
   | **QQ**       | App ID、Client Secret                                |
   | **iMessage** | 数据库路径、轮询间隔                                 |
   | **Console**  | _（只需开关）_                                       |

4. 点 **保存**，几秒内自动生效，无需重启。

**禁用一个频道：**
打开同一个配置面板，关闭 **启用** 开关，然后 **保存**。

> 各平台的凭据获取步骤，请看 [频道配置](./channels)。

---

## 会话

> 侧边栏：**控制 → 会话**

在这里查看、筛选和清理所有频道的聊天会话。

![会话](https://img.alicdn.com/imgextra/i2/O1CN01BjMbW61VqwTtJmqB1_!!6000000002705-2-tps-4066-2118.png)

**查找会话：**
在搜索框中输入用户名过滤，或用下拉菜单按频道筛选，表格会即时更新。

**重命名会话：**
点击某行的 **编辑** 按钮 → 修改名称 → 点 **保存**。

![编辑会话](https://img.alicdn.com/imgextra/i4/O1CN01SoWIwD1NwQIKa70rc_!!6000000001634-2-tps-4066-2118.png)

**删除单条会话：**
点击某行的 **删除** 按钮 → 弹窗确认即可。

**批量删除：**
勾选要删除的行 → 点击出现的 **批量删除** 按钮 → 确认。

---

## 定时任务

> 侧边栏：**控制 → 定时任务**

在这里创建和管理 CoPaw 按时间自动执行的定时任务。

![定时任务](https://img.alicdn.com/imgextra/i2/O1CN01JTEIm61U1MFz3kDn2_!!6000000002457-2-tps-4066-2118.png)

**创建新任务：**

1. 点击 **+ 创建任务** 按钮。
   ![创建定时任务](https://img.alicdn.com/imgextra/i4/O1CN01lIwzqd1ITxbOPfy4s_!!6000000000895-2-tps-4066-2118.png)
2. 按区域填写表单：
   - **基本信息** —— 给任务一个 ID（如 `job-001`）、一个名称（如「每日摘要」），
     并打开启用开关。
   - **调度** —— 填写 Cron 表达式（如 `0 9 * * *` = 每天上午 9 点）并选择时区。
   - **任务内容** —— 选择 **文本**（发送固定消息）或 **Agent**（向 CoPaw 提问并
     转发回复），然后填入具体内容。
   - **投递** —— 选择目标频道（如 Console、钉钉）、目标用户，以及投递方式
     （**流式** = 实时发送，**最终** = 完成后一次性发送）。
   - **高级选项** —— 按需调整最大并发数、超时时间和宽限时间。
3. 点 **保存**。

**编辑任务：**
点击某行的 **编辑** 按钮 → 修改任意字段 → **保存**。

**启用 / 禁用任务：**
点击行内的开关即可。

**立即执行一次：**
点击 **立即执行** → 确认，任务会马上运行一次。

**删除任务：**
点击 **删除** → 确认。

---

## 工作区

> 侧边栏：**智能体 → 工作区**

在这里编辑定义 CoPaw 人设和行为的文件——SOUL.md、AGENTS.md、
HEARTBEAT.md 等——全部在浏览器中完成。

![工作区](https://img.alicdn.com/imgextra/i1/O1CN01XJ9t7H1K1gNbIWAmF_!!6000000001104-2-tps-4066-2118.png)

**编辑文件：**

1. 点击文件列表中的文件名（如 `SOUL.md`）。
2. 文件内容出现在编辑器中，修改内容。
3. 点 **保存** 生效，或点 **重置** 放弃修改并重新加载。

**查看每日记忆：**
如果存在 `MEMORY.md`，点击旁边的 **▶** 箭头可展开按日期分组的条目，点击某个日期
即可查看或编辑当天的记忆。

**下载整个工作区：**
点击 **下载** 按钮（⬇），工作区会打包为 `.zip` 文件保存到本地。

**上传 / 恢复工作区：**
点击 **上传** 按钮（⬆）→ 选择 `.zip` 文件（最大 100 MB），当前工作区文件会被替换。
适合在不同机器之间迁移或从备份恢复。

---

## 技能

> 侧边栏：**智能体 → 技能**

在这里管理扩展 CoPaw 能力的技能（如读取 PDF、创建 Word 文档、获取新闻等）。

![技能](https://img.alicdn.com/imgextra/i2/O1CN01ovyeE126g4rr18aGy_!!6000000007690-2-tps-4066-2118.png)

**启用技能：**
点击技能卡片底部的 **启用** 链接，立即生效。

**查看技能详情：**
点击技能卡片可查看完整说明。

![查看技能](https://img.alicdn.com/imgextra/i4/O1CN01eGNz8i1YMCkPrtYlA_!!6000000003044-2-tps-4066-2118.png)

**禁用技能：**
点击 **禁用** 链接，同样立即生效。

**创建自定义技能：**

1. 点击 **+ 创建技能**。
2. 输入技能名称（如 `weather_query`）和技能内容（Markdown 格式，需包含 `name`
   和 `description`）。
3. 点 **保存**，新技能立即出现。

![创建技能](https://img.alicdn.com/imgextra/i3/O1CN01zgS3wZ1vm4H9zPnYU_!!6000000006214-2-tps-4066-2118.png)

**删除自定义技能：**
先禁用该技能，然后点击卡片上的 **🗑** 图标 → 确认删除。

> 内置技能说明和自定义技能编写方法，请看 [技能](./skills)。

---

## 模型

> 侧边栏：**设置 → 模型**

在这里配置 LLM 提供商并选择 CoPaw 使用的模型。CoPaw 同时支持云提供商（需要
API Key）和本地提供商（无需 API Key）。

![模型](https://img.alicdn.com/imgextra/i3/O1CN012pAWrv1yJcWSFSeoV_!!6000000006558-2-tps-4066-2118.png)

### 云提供商

**配置提供商：**

1. 点击提供商卡片（ModelScope、DashScope 或 Custom）上的 **⚙ 设置** 按钮。
   ![提供商设置](https://img.alicdn.com/imgextra/i4/O1CN015yz1LK1i0oPBn9fP7_!!6000000004351-2-tps-4066-2118.png)
2. 输入你的 **API Key**（Custom 提供商还需填写 **接入地址**）。
3. 点 **Save**，卡片状态变为「已授权」。

**撤销授权：**
打开提供商的设置对话框，点击 **Revoke Authorization**，API Key 会被清除；
如果当前使用的就是该提供商，模型选择也会一并清空。

### 本地提供商（llama.cpp / MLX）

本地提供商显示紫色的 **Local** 标签，状态始终为 **就绪**——无需配置 API Key。
使用前需先安装后端依赖（`pip install 'copaw[llamacpp]'` 或
`pip install 'copaw[mlx]'`）。

**下载模型：**

1. 点击本地提供商卡片上的 **管理模型**。
   <!-- TODO: 截图——模型管理弹窗，展开下载表单 -->
   ![模型管理弹窗](images/local-models-manage-modal.png)
2. 点击 **下载模型**，填写：
   - **Repo ID**（必填）—— 如 `Qwen/Qwen3-4B-GGUF`
   - **文件名**（可选）—— 留空自动选择
   - **下载源** —— Hugging Face（默认）或 ModelScope
3. 点击 **下载**。面板中会显示进度，完成后弹出提示通知。
   <!-- TODO: 截图——下载进行中，显示加载动画和状态文字 -->
   ![下载进度](images/local-models-download-progress.png)

**查看和删除模型：**
已下载的模型列在管理面板中，显示文件大小、来源标记（**HF** / **MS**）和删除按钮。

<!-- TODO: 截图——已下载模型列表，显示 HF/MS 标记和删除按钮 -->

![已下载模型列表](images/local-models-list.png)

> 完整说明请看 [本地模型](./local-models)。

### Ollama 提供商

Ollama 提供商集成本地 Ollama 守护进程，动态加载其中的模型。模型卡片显示蓝色 **Ollama** 标签。

**前置条件：**

- 从 [ollama.com](https://ollama.com) 安装 Ollama
- 安装 Ollama SDK：`pip install ollama`

**下载模型：**

1. 点击 Ollama 提供商卡片的 **管理模型**。
   <!-- TODO: 截图——Ollama 模型管理弹窗，显示下载表单 -->
   ![Ollama 管理弹窗](images/ollama-manage-modal.png)
2. 点击 **下载模型**，输入 **模型名称**（如 `mistral:7b`、`qwen3:8b`）。
3. 点击 **下载**。面板中会显示实时进度状态。
   <!-- TODO: 截图——Ollama 下载进行中，显示状态和取消按钮 -->
   ![Ollama 下载进度](images/ollama-download-progress.png)

**取消下载：**
下载过程中，点击进度指示器旁的 **✕** 按钮即可取消。

**查看和删除模型：**
已下载的模型列在管理面板中，显示大小和删除按钮。通过 Ollama CLI 或控制台添加/删除模型时，列表会自动更新。

<!-- TODO: 截图——Ollama 模型列表，显示模型大小和删除按钮 -->

![Ollama 模型列表](images/ollama-models-list.png)

**与本地模型的区别：**

- 模型来自 Ollama 守护进程（不由 CoPaw 直接下载）
- 模型列表与 Ollama 自动同步
- 支持热门模型：`mistral:7b`、`qwen3:8b` 等

> 也可以通过 CLI 管理 Ollama 模型：`copaw models ollama-pull`、`copaw models ollama-list`、`copaw models ollama-remove`。详见 [CLI](./cli#ollama-模型)。

### 选择活跃模型

1. 在提供商卡片下方的 **LLM** 区域，从下拉菜单选择一个 **提供商**（只显示已授权或
   有已下载模型的本地提供商）。
2. 选择或输入 **模型** 名称。
3. 点 **Save**。

> **注意：** 云提供商 API Key 的有效性需要用户自行保证，CoPaw 不会验证。
>
> 提供商详细说明见 [配置 — 模型提供商](./config#模型提供商)。

---

## 环境变量

> 侧边栏：**设置 → 环境变量**

在这里管理 CoPaw 的工具和技能在运行时需要的环境变量（如 `TAVILY_API_KEY`）。

![环境变量](https://img.alicdn.com/imgextra/i3/O1CN01cxOtGy1q6mUe8MBBs_!!6000000005447-2-tps-4066-2118.png)

**添加变量：**

1. 点击底部的 **+ 添加变量**。
2. 输入变量名（如 `TAVILY_API_KEY`）和对应的值。
3. 点工具栏的 **保存**。

**编辑变量：**
修改已有行的 **Value** 字段，然后点 **保存**。
（变量名保存后为只读，如需改名请先删除再新建。）

**删除变量：**
点击行右侧的 **🗑** 图标 → 如有提示则确认。

**批量删除：**
勾选要删除的行 → 点工具栏的 **删除** → 确认。

> **注意：** 环境变量值的有效性需要用户自行保证，CoPaw 只负责存储和加载。
>
> 更多说明见 [配置 — 环境变量](./config#环境变量)。

---

## 快速索引

| 页面     | 侧边栏路径      | 你能做什么                                         |
| -------- | --------------- | -------------------------------------------------- |
| 聊天     | 聊天 → 聊天     | 和 CoPaw 对话、管理会话                            |
| 频道     | 控制 → 频道     | 启用/禁用频道、填入凭据                            |
| 会话     | 控制 → 会话     | 筛选、重命名、删除会话                             |
| 定时任务 | 控制 → 定时任务 | 创建/编辑/删除任务、立即执行                       |
| 工作区   | 智能体 → 工作区 | 编辑人设文件、查看记忆、上传/下载                  |
| 技能     | 智能体 → 技能   | 启用/禁用/创建/删除技能                            |
| 模型     | 设置 → 模型     | 配置提供商 API Key、管理本地/Ollama 模型、选择模型 |
| 环境变量 | 设置 → 环境变量 | 添加/编辑/删除环境变量                             |

---

## 相关页面

- [配置与工作目录](./config) —— 配置字段、提供商、环境变量
- [频道配置](./channels) —— 各频道的接入步骤和凭据获取
- [技能](./skills) —— 内置技能说明和自定义技能编写
- [心跳](./heartbeat) —— 心跳配置
- [本地模型](./local-models) —— 通过 llama.cpp 或 MLX 运行本地模型
- [CLI](./cli) —— 命令行参考
